

{% extends 'exam-base.html' %}
{% load static %}

{% block title %}Discere{% endblock %}

{% block main_content %}
<div class="bg-white1 flex-grow px-10 py-10 rounded-t-3xl min-h-full">
    <div class="flex justify-between items-center mb-4">
        <a href="{% url 'library' %}" class="flex items-center">
            <img src="{% static 'icons/arrow-left.svg' %}" alt="Back" class="h-10 w-10 mr-2 text-darkgreen fill-current mt-2">
        </a>
        
        <h1 class="font-bold text-4xl ml-0">
            {{ exam_set.set_name }}
        </h1>

        <div class="flex space-x-4">
            <button id="open-modal"
                    class="text-darkgreen font-semibold py-2 px-4 rounded-full w-64 h-16 flex items-center justify-center text-lg border-2 border-[#012d19] hover:bg-[#012d19] hover:text-white hover:border-transparent">
                <i class="fa fa-magic mr-2 text-sm"></i>
                Create Exam Card
            </button>


            <div class="h-[65px] border-t border-transparent ml-10"></div>
        </div>
    </div>

    <div class="w-full h-px bg-opacity-10 border-t border-lightgrey mt-6"></div>

    <div class="text-right flex justify-between items-center text-2xl">
        <div class="bg-white rounded-b-lg flex border-2 border-darkgreen">
            <div class="text-darkgreen px-5 flex justify-center items-center">
                <strong class="text-darkgreen">SUBJECT</strong>
            </div>
            <div class="bg-darkgreen text-white px-5 py-2">
                {{ exam_set.set_subject }}
            </div>
        </div>
    
        <div class="bg-white rounded-b-lg flex border-2 border-darkgreen ml-4">
            <div class="text-darkgreen px-5 py-2">
                <strong class="text-darkgreen">EXAM CARD COUNT</strong>
            </div>
            <div class="bg-darkgreen text-white px-5 py-2" id="exam-card-counter">
                1
            </div>
        </div>
    </div>
    

    <div class="py-10">
        <form method="POST" action="{% url 'exam_card_view' %}">
            {% csrf_token %}
            <input type="hidden" name="exam_set" value="{{ exam_set.id }}">

            <div id="exam-cards">
                <div class="exam-card">
                    <div class="exam-card-header">
                        <span class="exam-card-number">1</span>
                        <button type="button" class="delete-btn">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>

                    <div class="exam-card-content">
                        <div class="input-group">
                            <input type="text"
                                   name="term_1"
                                   class="input-term border border-darkgreen rounded p-2 w-full"
                                   placeholder="Enter term" required>
                            <p class="label">TERM</p>
                        </div>

                        <div class="input-group">
                            <input type="text"
                                   name="definition_1"
                                   class="input-definition border border-darkgreen rounded p-2 w-full"
                                   placeholder="Enter definition" required>
                            <p class="label">DEFINITION</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="add-card-section mt-4">
                <div class="add-card">
                    <button type="button" class="add-card-btn text-darkgreen font-semibold border-2 border-[#012d19] py-2 px-4 rounded-full w-64 h-16 flex items-center justify-center text-lg transform transition-transform duration-300 hover:scale-100">
                        <i class="fas fa-plus mr-2"></i> ADD CARD
                    </button>
                </div>
            </div>            

            <div class="flex justify-end items-center mr-36 mb-2">
                <button class="text-darkgreen font-semibold py-2 px-4 rounded-full w-64 h-16 flex items-center justify-center text-lg border-2 border-darkgreen hover:bg-[#012d19] hover:text-white" type="submit">
                    <i class="fa fa-magic mr-2 text-sm"></i>
                    Create Exam Card
                </button>
            </div>
        </form>

        <div id="modal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="warning-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <p class="warning-message">This is the last exam card of the set.<br>Unable to delete!</p>
            </div>
        </div>

        <script src="{% static 'flashcards/js/flashcards.js' %}"></script>
        <script>
            document.getElementById("open-modal").addEventListener("click", function() {
                document.querySelector("form").submit();
            });

            document.getElementById("start-learning").addEventListener("click", function(e) {
                e.preventDefault();
                document.querySelector("form").submit();  
                setTimeout(function() {
                    window.location.href = document.getElementById("start-learning-link").href;
                }, 100);
            });

            document.getElementById("delete").addEventListener("click", function(e) {
                e.preventDefault();  
                if (confirm("Are you sure you want to delete this exam set? This action cannot be undone.")) {
                    document.getElementById("delete-exam-set-form").submit();  
                }
            });
        </script>
    </div>
</div>
{% endblock %}
